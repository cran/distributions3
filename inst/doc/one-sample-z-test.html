<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>One sample Z-tests</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">One sample Z-tests</h1>



<p>In this vignette, we work through an example Z-test, and point out a
number of points where you might get stuck along the way.</p>
<div id="problem-setup" class="section level2">
<h2>Problem setup</h2>
<p>Let’s suppose that a student is interesting in estimating how many
memes their professors know and love. So they go to class, and every
time a professor uses a new meme, they write it down. After a year of
classes, the student has recorded the following meme counts, where each
count corresponds to a single class they took:</p>
<p><span class="math display">\[
  3, 7, 11, 0, 7, 0, 4, 5, 6, 2
\]</span></p>
<p>The student talks to some other students who’ve done similar studies
and determines that <span class="math inline">\(\sigma = 2\)</span> is a
reasonable value for the standard deviation of this distribution.</p>
</div>
<div id="assumption-checking" class="section level2">
<h2>Assumption checking</h2>
<p>Before we can do a Z-test, we need to make check if we can reasonably
treat the mean of this sample as normally distributed. This happens is
the case of either of following hold:</p>
<ol style="list-style-type: decimal">
<li>The data comes from a normal distribution.</li>
<li>We have lots of data. How much? Many textbooks use 30 data points as
a rule of thumb.</li>
</ol>
<p>Since we have a small sample, we should check if the data comes from
a normal distribution using a normal quantile-quantile plot.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># read in the data</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># make the qqplot</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">qqnorm</span>(x)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">qqline</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Since the data lies close the line <span class="math inline">\(y =
x\)</span>, and has no notable systematic deviations from line, it’s
safe to treat the sample as coming from a normal distribution. We can
proceed with our hypothesis test.</p>
</div>
<div id="null-hypothesis-and-test-statistic" class="section level2">
<h2>Null hypothesis and test statistic</h2>
<p>Let’s test the null hypothesis that, on average, professors know 3
memes. That is</p>
<p><span class="math display">\[
  H_0: \mu = 3 \qquad H_A: \mu \neq 3
\]</span></p>
<p>First we need to calculate our Z-statistic. Let’s do this with R.
Remember that the Z-statistic is defined as</p>
<p><span class="math display">\[
  Z = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}} \sim \mathrm{Normal}(0,
1)
\]</span></p>
</div>
<div id="calculating-p-values" class="section level2">
<h2>Calculating p-values</h2>
<p>In R this looks like:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># calculate the z-statistic</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>z_stat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>z_stat</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; [1] 2.371708</span></span></code></pre></div>
<p>To calculate a two-sided p-value, we need to find</p>
<p><span class="math display">\[
\begin{align}
  P(|Z| \ge |2.37|)
  &amp;= P(Z \ge 2.37) + P(Z \le -2.37) \\
  &amp;= 1 - P(Z \le 2.37) + P(Z \le -2.37) \\
  &amp;= 1 - \Phi(2.37) + \Phi(-2.37)
\end{align}
\]</span></p>
<p>To do this we need to c.d.f. of a standard normal</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(distributions3)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">Normal</span>(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># make a standard normal r.v.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">cdf</span>(Z, <span class="fl">2.37</span>) <span class="sc">+</span> <span class="fu">cdf</span>(Z, <span class="sc">-</span><span class="fl">2.37</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.01778809</span></span></code></pre></div>
<p>Note that we saved <code>z_stat</code> above so we could have also
done</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">cdf</span>(Z, <span class="fu">abs</span>(z_stat)) <span class="sc">+</span> <span class="fu">cdf</span>(Z, <span class="sc">-</span><span class="fu">abs</span>(z_stat))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.01770607</span></span></code></pre></div>
<p>which is slightly more accurate since there is no rounding error.</p>
<p>So our p-value is about 0.0177. You should verify this with a
Z-table. Note that you should get the <em>same</em> value from
<code>cdf(Z, 2.37)</code> and looking up <code>2.37</code> on a
Z-table.</p>
<p>You may also have seen a different formula for the p-value of a
two-sided Z-test, which makes use of the fact that the normal
distribution is symmetric:</p>
<p><span class="math display">\[
\begin{align}
  P(|Z| \ge |2.37|)
  &amp;= 2 \cdot P(Z \le -|2.37|) \\
  &amp;= 2 \cdot \Phi(-2.37)
\end{align}
\]</span></p>
<p>Using this formula we get the same result:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">cdf</span>(Z, <span class="sc">-</span><span class="fl">2.37</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.01778809</span></span></code></pre></div>
<p>Finally, sometimes we are interest in one sided Z-tests. For the
test</p>
<p><span class="math display">\[
\begin{align}
  H_0: \mu \le 3 \qquad H_A: \mu &gt; 3
\end{align}
\]</span></p>
<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &gt; 2.37)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">cdf</span>(Z, <span class="fl">2.37</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.008894043</span></span></code></pre></div>
<p>For the test</p>
<p><span class="math display">\[
  H_0: \mu \ge 3 \qquad H_A: \mu &lt; 3
\]</span></p>
<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &lt; 2.37)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cdf</span>(Z, <span class="fl">2.37</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.991106</span></span></code></pre></div>
</div>
<div id="rejection-regions" class="section level2">
<h2>Rejection regions</h2>
<p><strong>Preface</strong>: I am strongly opposed to make a dichotomous
“reject/fail to reject” decision for hypothesis tests. If you do a
hypothesis test, you should report the p-value, period. Picking an
arbitrary <span class="math inline">\(\alpha\)</span> level rejection
threshold and treating it as a gold standard is ridiculous, as evidenced
by 60 years of statistical literature laden with warnings about
hypothesis testing. That said, sometimes it can be useful to think about
when you reject a hypothesis test.</p>
<p>We can think about three different rejection regions for a
Z-test:</p>
<ol style="list-style-type: decimal">
<li>The rejection region in terms of the p-value</li>
<li>The rejection region in terms of the test statistic</li>
<li>The rejection region in terms of the sample mean</li>
</ol>
<p>For a given <span class="math inline">\(\alpha\)</span> level
threshold, all of these rejection regions are equivalent. We’ll start by
thinking about the rejection of a two-sided test. That is</p>
<p><span class="math display">\[
\begin{align}
H_0 : \mu = \mu_0 \qquad H_A : \mu \neq \mu_0
\end{align}
\]</span></p>
<p>We then calculate a test statistic <span class="math inline">\(Z_\text{obs}\)</span>, and a p-value <span class="math inline">\(P(|Z| &gt; |Z_\text{obs}|)\)</span> and reject
when <span class="math inline">\(P(|Z| &gt; |Z_\text{obs}|) &lt;
\alpha\)</span>. This defines our first rejection region. Using our
observation from before, this is exactly equivalent to rejecting
when</p>
<p><span class="math display">\[
\begin{align}
P(|Z| &gt; |Z_\text{obs}|) &lt; \alpha
&amp; \Longleftrightarrow 2 \cdot P(Z &lt; -|Z_\text{obs}|) &lt; \alpha
\\
&amp; \Longleftrightarrow P(Z &lt; -|Z_\text{obs}|) &lt; \alpha / 2
\end{align}
\]</span></p>
<p>and this last statement is exactly the same as when <span class="math inline">\(Z_\text{obs} &lt; z_{\alpha / 2}\)</span> or <span class="math inline">\(z_{1 - \alpha / 2} &lt; Z_\text{obs}\)</span>.
This is our second region region, in terms of the test statistic.
Finally, recall that</p>
<p><span class="math display">\[
  Z_\text{obs} = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}}
\]</span></p>
<p>So we take the conditions and rearrange to in terms of <span class="math inline">\(\bar x\)</span></p>
<p><span class="math display">\[
\begin{align}
\frac{\bar x - \mu_0}{\sigma / \sqrt{n}} &gt; z_{1 - \alpha / 2}
&amp; \Longleftrightarrow \bar x &gt; \mu_0 + z_{1 - \alpha / 2}
\frac{\sigma}{\sqrt n}
\end{align}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{align}
\frac{\bar x - \mu_0}{\sigma / \sqrt{n}} &lt; z_{\alpha / 2}
&amp; \Longleftrightarrow \bar x &lt; \mu_0 + z_{\alpha / 2}
\frac{\sigma}{\sqrt n}
\end{align}
\]</span></p>
<p>You can also think about this in terms of <span class="math inline">\(\mu_0\)</span>. We will reject the test when <span class="math inline">\(\mu_0\)</span> is not in</p>
<p><span class="math display">\[
\begin{align}
\left( \bar x + z_{\alpha / 2} \frac{\sigma}{\sqrt n},
  \bar x + z_{1 - \alpha / 2} \frac{\sigma}{\sqrt n} \right)
\end{align}
\]</span></p>
<p>which you may recognize as the confidence interval for <span class="math inline">\(\mu\)</span>! So the confidence interval contains
all the values of <span class="math inline">\(\mu_0\)</span> that we
cannot reject at the <span class="math inline">\(\alpha\)</span> level.
You can perform a similar calculation for a one sided test, resulting in
a one-sided confidence bound, where one end of the interval is either
<span class="math inline">\(\infty\)</span> or <span class="math inline">\(-\infty\)</span>.</p>
</div>
<div id="power-and-sample-size-calculations" class="section level2">
<h2>Power and sample size calculations</h2>
<div id="formulas-for-power" class="section level3">
<h3>Formulas for power</h3>
<p>We want to make sure that we actually reject our null hypothesis in
the case that it is false. That is, we would like to make sure that our
test has high power. Mathematically, this means that <span class="math inline">\(P(\text{reject } H_0 | H_0 \text{ is
false})\)</span>. The problem here is that <span class="math inline">\(H_0\)</span> can be wrong in many different ways:
it could be that the true <span class="math inline">\(\mu\)</span> is
<span class="math inline">\(2\)</span>, it could be <span class="math inline">\(7\)</span>, it could be <span class="math inline">\(4.26\)</span>. So to calculate power as formulated
above is not really possible. However, we can calculate power for
specific versions of “<span class="math inline">\(H_0\)</span> is
false”.</p>
<p>Let’s consider the case that <span class="math inline">\(H_0\)</span>
is false, and in particular the true value of <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\mu_A\)</span>. In this case, the power of our
test is <span class="math inline">\(P(\text{reject } H_0 | \mu =
\mu_A)\)</span>. <a href="#rejection-regions">Recall</a> that we reject
<span class="math inline">\(H_0\)</span> when <span class="math inline">\(\bar{x} &gt; \mu_0 + z_{1 - \alpha / 2}
\frac{\sigma}{\sqrt n}\)</span> or <span class="math inline">\(\bar{x}
&lt; \mu_0 + z_{\alpha / 2} \frac{\sigma}{\sqrt n}\)</span>, so the
power of our test when <span class="math inline">\(\mu = \mu_A\)</span>
is</p>
<p><span class="math display">\[
  P(\text{reject } H_0 \left | \mu = \mu_A \right .) =
  P\left( \left . \bar x &gt; \mu_0 + z_{1 - \alpha / 2}
    \frac{\sigma}{\sqrt n} \right | \mu =
  \mu_A \right) + P\left( \left . \bar x &lt; \mu_0 + z_{\alpha / 2}
    \frac{\sigma}{\sqrt n} \right | \mu = \mu_A \right).
\]</span></p>
<p>Remember that <span class="math inline">\(\bar X \sim \mathrm{Normal}
\left(\mu, \frac{\sigma^2}{n} \right)\)</span>. This means that, given
<span class="math inline">\(\mu = \mu_A\)</span>, <span class="math inline">\(\bar{x} \sim \mathrm{Normal} \left(\mu,
\frac{\sigma^2}{n} \right)\)</span>, which let’s us calculate the
probabilities we need to find the power:</p>
<p><span class="math display">\[
\begin{align}
  P\left( \left . \bar{x} &gt; \mu_0 + z_{1 - \alpha / 2}
\frac{\sigma}{\sqrt n} \right | \mu = \mu_A \right)
  &amp;= P\left( \frac{\bar{x} - \mu_A}{\sigma/\sqrt{n}} &gt;
\frac{\mu_0 + z_{1-\alpha/2}\frac{\sigma}{\sqrt{n}} -
\mu_A}{\sigma/\sqrt{n}} \right) \\
  &amp;= P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} +
z_{1-\alpha/2} \right),
\end{align}
\]</span></p>
<p>and similarly</p>
<p><span class="math display">\[
  P\left( \left . \bar{x} &lt; \mu_0 + z_{\alpha / 2}
\frac{\sigma}{\sqrt n} \right | \mu = \mu_A\right) = P\left( Z &lt;
\frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right).
\]</span></p>
<p>So, the power of our test, <em>if the true population mean is <span class="math inline">\(\mu_A\)</span></em>, is</p>
<p><span class="math display">\[
\begin{align}
  \text{Power} &amp;= P\left( Z &gt; \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) + P\left( Z &lt;
\frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right) \\
  &amp;= \left[1 - P\left( Z &lt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}}
+ z_{1-\alpha/2} \right)\right] + P\left( Z &lt; \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right)
\end{align}
\]</span></p>
<p>Let’s calculate this if <span class="math inline">\(\mu_A =
5\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>power_lower <span class="ot">&lt;-</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">5</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">quantile</span>(Z, <span class="fl">0.025</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>power_upper <span class="ot">&lt;-</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">5</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">quantile</span>(Z, <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.025</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">cdf</span>(Z, power_lower) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cdf</span>(Z, power_upper))</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.8853791</span></span></code></pre></div>
<p>This means that the probability that we reject the null hypothesis
(<span class="math inline">\(H_0: \mu = 3\)</span>) if the true mean is
<span class="math inline">\(5\)</span> is about 0.89.</p>
</div>
<div id="formulas-for-sample-size-calculations" class="section level3">
<h3>Formulas for sample size calculations</h3>
<p>Often times researchers like to go in the other direction: aim for a
specific level of power, and calculate how many observations are needed
to reach that level. To achieve a power of <span class="math inline">\(1
- \beta\)</span> for a one sample Z-test with <span class="math inline">\(H_0 : \mu = \mu_0\)</span>, you need</p>
<p><span class="math display">\[
  n \approx \left(
    {
      \sigma \cdot (z_{\alpha / 2} + z_\beta) \over
      \mu_0 - \mu_A
    }
  \right)^2
\]</span></p>
<p>samples. If <span class="math inline">\(n\)</span> is not an integer,
round up. Often, the denominator is thought of as the detectable
difference. So, the question becomes how many samples are required to
have sufficient power to detect a difference of some particular
size.</p>
<p>This equation is simply a rewrite of the equation presented above for
power. Recall, the power for a two sided test is</p>
<p><span class="math display">\[
\text{Power} = P\left( Z &gt; \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} +
z_{1-\alpha/2} \right) + P\left( Z &lt; \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{\alpha/2} \right).
\]</span></p>
<p>Usually, only one of these terms is contributing while the other is
very close to zero. Let’s say the first term is the one clearly
different from zero. To determine the sample size, we want to determine
<span class="math inline">\(n\)</span> such that <span class="math inline">\(P\left( Z &gt; \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) = 1-\beta\)</span>. Or,
similarly, <span class="math inline">\(P\left( Z &lt; \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} \right) = \beta\)</span>. I.e.
we need <span class="math inline">\(\frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} = z_{\beta}\)</span>.</p>
<p><span class="math display">\[
\begin{align}
z_{\beta} = \frac{\mu_0 - \mu_A}{\sigma/\sqrt{n}} + z_{1-\alpha/2} &amp;
\Longleftrightarrow z_{\beta} - z_{1-\alpha/2} = \frac{\mu_0 -
\mu_A}{\sigma/\sqrt{n}} \\
  &amp; \Longleftrightarrow \sigma (z_{\beta} - z_{1-\alpha/2}) =
(\mu_0-\mu_A)\sqrt{n} \\
&amp; \Longleftrightarrow \frac{\sigma (z_{\beta} -
z_{1-\alpha/2})}{\mu_0-\mu_A} = \sqrt{n} \\
&amp; \Longleftrightarrow \left(\frac{\sigma (z_{\beta} -
z_{1-\alpha/2})}{\mu_0-\mu_A}\right)^2 = n
\end{align}
\]</span></p>
<p>Since <span class="math inline">\(z_{1-\alpha/2} =
-z_{\alpha/2}\)</span>, we have the equation above:</p>
<p><span class="math display">\[
  \left(\frac{\sigma (z_{\beta} + z_{\alpha/2})}{\mu_0-\mu_A}\right)^2 =
n.
\]</span></p>
<p>As an example, say the student prior to the experiment had determined
that they wanted to test if the number of memes their professors know
and love is 2. They want to make sure their sample size is large enough
so that they are likely to reject the null hypothesis if the true number
is 3. They determine that they want a probability of 0.9 of rejecting
the null if the true number is 3. So, a sample size calculation looks
like this:</p>
<p><span class="math display">\[
  n \approx \left(
    {
      2 \cdot (1.96 + 1.28) \over
      2-3
    }
  \right)^2 = 41.99
\]</span></p>
<p>So to make sure that they reject the null hypothesis with a
probability of 0.9 if the true value is 3, they would have to ask 53
professors.</p>
<p>Below is this same calculation done in <code>R</code>. Remember,
<span class="math inline">\(\beta = 1-\text{Power}\)</span>. Note the
small discrepancy. This is due to rounding error.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>(<span class="dv">2</span> <span class="sc">*</span> (<span class="fu">quantile</span>(Z, <span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fu">quantile</span>(Z, <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.9</span>)) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; [1] 42.02969</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
